snow={count:60,delay:20,flutter:.2,wobble:.5,spin:1,wind:1,w1:1,minSpeed:.3,maxSpeed:4,cv:null,flakes:[],toggle:function(){if(window.snowtimer)snow.stop();else snow.start()},resize:function(){snow.cv.width=innerWidth;snow.cv.height=innerHeight;snow.gt=snow.ct.createLinearGradient(0,0,0,snow.cv.height);snow.gt.addColorStop(0,"#6666ff");snow.gt.addColorStop(1,"#ffffff");snow.ct.fillStyle=snow.gt},start:function(){snow.cv=document.createElement("canvas");snow.cv.width=snow.cv.height=10;snow.cv.id="backgroundSnowCanvas";document.body.appendChild(snow.cv);snow.createFlake();snow.ct=snow.cv.getContext("2d"),snow.cv.style.position="fixed";snow.cv.style.top=0;snow.cv.style.left=0;snow.cv.style.zIndex=-1;snow.resize();var e=snow.count;snow.flakes=[];do{snow.flakes.push(new snow.flake)}while(--e);snow.ct.fillRect(0,0,snow.cv.width,snow.cv.height);window.snowtimer=window.setInterval(snow.draw,snow.delay);window.addEventListener("resize",snow.resize)},stop:function(){window.clearInterval(window.snowtimer);var e=document.getElementById("backgroundSnowCanvas");e.parentNode.removeChild(e);window.snowtimer=snow=null},draw:function(){var e=snow.ct,t=snow.flakes,n=snow.count;e.fillRect(0,0,snow.cv.width,snow.cv.height);do{if(t[--n].draw(e)&&++fdone){}}while(n);snow.wind+=Math.cos(snow.w1++/180)},flake:function(){this.draw=function(e){var t=this.x+snow.wind,n=this.y,r=t+this.sz/2,i=n+this.sz/2;e.translate(r,i);e.rotate(this.a);e.translate(-r,-i);e.drawImage(snow.flakeImages[this.flake],t,n,this.sz,this.sz);if(this.flakebits>=0)e.drawImage(snow.flakeBits[this.flakebits],t,n,this.sz,this.sz);e.setTransform(1,0,0,1,0,0);this.animate()};this.animate=function(){this.y+=this.speed;this.x+=this.flutter*Math.cos(snow.flutter*snow.flutter*this.y);this.a=this.spin*this.y+this.wobble*Math.sin(this.y/this.sz);if(this.y>innerHeight)this.init(1)};this.init=function(e){this.speed=snow.minSpeed+Math.random()*(snow.maxSpeed-snow.minSpeed);this.sz=~~(Math.random()*40)+20;this.flutter=~~(Math.random()*snow.flutter*(60-this.sz));this.wobble=Math.random()*snow.wobble;this.spin=snow.spin*.1*(Math.random()-.5);this.a=0;this.x=Math.random()*(innerWidth+this.sz)-this.sz;this.y=e?-this.sz:Math.random()*innerHeight;this.flake=~~(Math.random()*snow.flakeImages.length);this.flakebits=~~(Math.random()*(snow.flakeBits.length+1))-1};this.init()},createFlake:function(){function a(e){e.arc(0,-16,4,0,7,0)}function f(e,t,n,r,i,s){e.moveTo(0,-n);e.lineTo(t,-r);e.lineTo(t,-i);e.lineTo(0,-r-s);e.lineTo(-t,-i);e.lineTo(-t,-r);e.lineTo(0,-n)}function l(e){f(e,5,6,8,10,0)}function c(e){f(e,5,10,12,14,0)}function h(e){f(e,4,6,8,12,2)}function p(e){f(e,9,6,8,11,0)}function d(e){f(e,4,16,16,18,2)}function v(e){f(e,5,12,12,14,2)}function m(e){a(e);h(e)}function g(e){c(e);h(e)}function y(e){l(e);c(e)}function b(e){a(e);l(e)}function w(e){d(e);v(e)}function E(e){d(e);p(e)}function S(e){d(e);h(e)}function x(e){d(e);l(e)}function T(e){v(e);l(e)}function N(e){d(e);c(e)}function C(e){a(e);p(e)}var e,t,n,r,i,s=document.createElement("canvas"),o,u;s.width=s.height=40;snow.flakeImages=[];snow.flakeBits=[];for(e=0;e<6;++e){snow.flakeImages[e]=r=s.cloneNode();n=r.getContext("2d");n.fillStyle="#fff";n.translate(20,20);n.beginPath();i=1+e/2;n.rect(-i,-20,i*2,40);n.rotate(Math.PI/3);n.rect(-i,-20,i*2,40);n.rotate(Math.PI/3);n.rect(-i,-20,i*2,40);n.closePath();n.fill()}u=[C,T,N,x,S,E,d,v,w,p,a,l,c,h,m,g,y,b];for(e=0;e<u.length;++e){snow.flakeBits[e]=r=s.cloneNode();o=u[e];n=r.getContext("2d");n.translate(20,20);n.fillStyle="#fff";for(t=0;t<6;++t){n.beginPath();o(n);n.closePath();n.fill();n.rotate(Math.PI/3)}}}}